<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>jqdap Example</title>
<style>
form>div>label {
  float: left;
  text-align: right;
  margin-right: 10px;
  width: 200px;
}
form>div>input, form>div>textarea {
  width: 400px;
}
form>input {
  margin-left: 210px;
}
</style>
</head>
<body>
<h1>jqdap Example</h1>
<h2>Request</h2>
<div>
  <form id="request">
    <div>
      <label>OPeNDAP Endpoint</label>
      <input id="endpoint" type="text">
    </div>
    <div>
      <label>OPeNDAP Query</label>
      <input id="query" type="text">
    </div>
    <div>
      <label>Username</label>
      <input id="username" type="text">
    </div>
    <div>
      <label>Password</label>
      <input id="password" type="password">
    </div>
    <input type="submit">
  </form>
</div>
<h2>Response</h2>
<div>
  <form id="response">
    <div>
      <label>Dataset</label>
      <textarea id="dataset" rows="5"></textarea>
    </div>
    <div>
      <label>Data</label>
      <textarea id="data" rows="5"></textarea>
    </div>
  </form>
</div>
<script src="../bower_components/jquery/dist/jquery.min.js"></script>
<script src="../jqdap.js"></script>
<script>
$(function() {
  $('form#request').submit(function() {
    var endpoint = document.getElementById('endpoint').value;
    var query = document.getElementById('query').value;
    var username = document.getElementById('username').value;
    var password = document.getElementById('password').value;
    var options = {};
    if (username || password) {
      options.username = username;
      options.password = password;
      options.withCredentials = true;
    };
    jqdap.loadData(endpoint + '.dods?' + query, options)
      .then(function(data) {
        document.getElementById('data').value = JSON.stringify(data);
      });
    jqdap.loadDataset(endpoint, options)
      .then(function(dataset) {
        document.getElementById('dataset').value = JSON.stringify(dataset);
      });
    return false;
  });
});
</script>
</body>
</html>
